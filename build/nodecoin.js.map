{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap e065698b199161523140","webpack:///./__mocks__/blocks.js","webpack:///external \"elliptic\"","webpack:///external \"ripemd160\"","webpack:///external \"js-sha256\"","webpack:///./src/index.js","webpack:///external \"babel-polyfill\"","webpack:///./src/utils/verifySignature.js","webpack:///./src/utils/makeWallet.js","webpack:///external \"coinstring\"","webpack:///external \"crypto\"","webpack:///external \"secure-random\""],"names":["MY_ADDRESS","FRIEND_ADDRESS","COIN","BLOCKS","hash","version","previousHash","timestamp","difficulty","nonce","blocksize","txs","vin","prevout","vout","value","scriptPubKey","n","scriptSig","myWallet","privateKey","publicKey","publicKeyHash","address","privateKeyWIF","txid","console","log","Hash","unlockTransaction","verifyUnlock","testVerification","ecdsa","msg","update","digest","keys","keyFromPrivate","signature","sign","toDER","e","isAddress","keyFromPublic","isValid","verify","split","getAddress","makeWallet","DEFAULT_VERSION","public","private","createHash","encode","randomBuffer","toString","getPublic","publicAddress","wallet"],"mappings":"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","file":"nodecoin.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"events\"] = factory();\n\telse\n\t\troot[\"events\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e065698b199161523140","const MY_ADDRESS = \"1Nd85AnFYDtaQAG6vF9FVWXFWksG5HuA3M\";\nconst FRIEND_ADDRESS = \"1PDLNfJq5GAEn5StESZuBpaBe6B3134vmD\";\nconst COIN = 100000000;\n\nconst BLOCKS = [\n  // Genesis block\n  {\n    hash: \"00000244a5bae572247ca9f5b9149fc3980fa90a7a70cd35030a29d81ebc88ea\",\n    version: 1,\n    previousHash: \"0000000000000000000000000000000000000000000000000000000000000000\",\n    timestamp: 1231006505000,\n    difficulty: 22,\n    nonce: 2620954,\n    blocksize: 441,\n    txs: [\n      {\n        hash: \"892d3a0a01ab1a1c3d67e1592e5bd11df687e26098dda08478e6a58e0f6b337a\",\n        vin: [\n          { prevout: \"COINBASE\" }\n        ],\n        vout: [\n          {\n            value: 50 * COIN,\n            scriptPubKey: MY_ADDRESS\n          }\n        ]\n      },\n    ]\n  },\n  // Block #2 - new Coinbase and give 20 BTC to friend\n  {\n    hash: \"000001a20dacb2ede72eb4b35dea74b83fd4bc0b23849b789fee19c7eac2f1b9\",\n    version: 1,\n    previousHash: \"00000244a5bae572247ca9f5b9149fc3980fa90a7a70cd35030a29d81ebc88ea\",\n    timestamp: 1520947111852,\n    difficulty: 22,\n    nonce: 210212,\n    blocksize: 225,\n    txs: [\n      {\n        hash: \"892d3a0a01ab1a1c3d67e1592e5bd11df687e26098dda08478e6a58e0f6b337a\",\n        vin: [\n          { prevout: \"COINBASE\" }\n        ],\n        vout: [\n          {\n            value: 50 * COIN,\n            scriptPubKey: MY_ADDRESS\n          }\n        ]\n      },\n      {\n        hash: \"522f5e10a101de1b8e2b2289b2f5801daf007221f01a7256a3c961c9d26412fc\",\n        vin: [\n          {\n            prevout: \"892d3a0a01ab1a1c3d67e1592e5bd11df687e26098dda08478e6a58e0f6b337a\",\n            n: 0,\n            scriptSig: \"044283eb5f9aa7421f646f266fbf5f7a72b7229a7b90a088d1fe45292844557b1d80ed9ac96d5b3ff8286e7794e05c28f70ae671c7fecd634dd278eb0373e6a3ba 3046022100f744154f854952dedd6d673b1f15fcf028159651816e61f1df62955802c8356a022100ec920c0128d84166a802441d174acd665c84d571f7ff908ae1acb95e43a996dc\"\n          }\n        ],\n        vout: [\n          {\n            value: 6 * COIN,\n            scriptPubKey: FRIEND_ADDRESS,\n          },\n          {\n            value: 44 * COIN,\n            scriptPubKey: MY_ADDRESS\n          }\n        ]\n      },\n    ]\n  },\n  // Block #3 - new Coinbase and get 5 BTC from friend\n  {\n    hash: \"00000369dd0974cb0a472a961247607c196e6353c3ea04746b9bde3272b7de6a\",\n    previousHash: \"000001a20dacb2ede72eb4b35dea74b83fd4bc0b23849b789fee19c7eac2f1b9\",\n    version: 1,\n    timestamp: 1520948119344,\n    difficulty: 22,\n    nonce: 6317304,\n    txs: [\n      {\n        hash: \"892d3a0a01ab1a1c3d67e1592e5bd11df687e26098dda08478e6a58e0f6b337a\",\n        vin: [\n          { prevout: \"COINBASE\" }\n        ],\n        vout: [\n          {\n            value: 50 * COIN,\n            scriptPubKey: MY_ADDRESS\n          }\n        ]\n      },\n      {\n        hash: \"\",\n        vin: [\n          {\n            prevout: \"522f5e10a101de1b8e2b2289b2f5801daf007221f01a7256a3c961c9d26412fc\",\n            n: 1,\n            scriptSig: \"304402201d66ed17c21543a2bed0d6f1a85b0929c6c2d5b024848471e5f72e95b9dbe95902202086c3ffa7e273f1cd4d6706f61960c8333a9700b0687dd2b1b7014bdb7c115a\"\n          },\n        ],\n        vout: [\n          {\n            value: 10 * COIN,\n            scriptPubKey: \"1PDLNfJq5GAEn5StESZuBpaBe6B3134vmD\"\n          },\n          {\n            value: 10 * COIN,\n            scriptPubKey: \"1Nd85AnFYDtaQAG6vF9FVWXFWksG5HuA3M\"\n          }\n        ]\n      }\n    ]\n  }\n];\n\nexport default BLOCKS;\n\n\n\n// WEBPACK FOOTER //\n// ./__mocks__/blocks.js","module.exports = require(\"elliptic\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"elliptic\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"ripemd160\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ripemd160\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"js-sha256\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"js-sha256\"\n// module id = 3\n// module chunks = 0","import 'babel-polyfill';\n\nimport { testVerification, unlockTransaction } from 'utils/verifySignature';\n\nimport blocks from '__mocks__/blocks';\n\nconst myWallet = {\n  privateKey      : '0fcb37c77f68a69b76cd5b160ac9c85877b4e8a09d8bcde2c778715c27f9a347',\n  publicKey       : '044283eb5f9aa7421f646f266fbf5f7a72b7229a7b90a088d1fe45292844557b1d80ed9ac96d5b3ff8286e7794e05c28f70ae671c7fecd634dd278eb0373e6a3ba',\n  publicKeyHash   : 'ed2f84f67943321bf73747936db3e7273ada7f6c',\n  address         : '1Nd85AnFYDtaQAG6vF9FVWXFWksG5HuA3M',\n  privateKeyWIF   : '5HwF1jU38V8YhpBy9PuNC4hTYkKrDccLE28qV7tLxZ7u3pKXCy4',\n};\n\nconst vin = {\n  txid: '522f5e10a101de1b8e2b2289b2f5801daf007221f01a7256a3c961c9d26412fc',\n  prevout: {\n    hash: '892d3a0a01ab1a1c3d67e1592e5bd11df687e26098dda08478e6a58e0f6b337a',\n    n: 0,\n    value: 5000000000,\n    scriptPubKey: '1Nd85AnFYDtaQAG6vF9FVWXFWksG5HuA3M',\n  },\n  scriptSig: '044283eb5f9aa7421f646f266fbf5f7a72b7229a7b90a088d1fe45292844557b1d80ed9ac96d5b3ff8286e7794e05c28f70ae671c7fecd634dd278eb0373e6a3ba 3044022040f0ef15e90e017b9cc1b8a06e397cac73678a95ae85bc6919a60ff62249e96802206c6a9f09c137e3dbd36a13e126d549cbc3cb2ab4e0b48f9333183e5f38dcff59',\n};\n\nconsole.log(testVerification(vin));\nconsole.log('\\n\\n\\n');\nconsole.log('> New signature: ', unlockTransaction(vin.txid, myWallet.privateKey));\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 5\n// module chunks = 0","import blocks from '__mocks__/blocks';\nimport { ec } from 'elliptic';\nimport { getAddress } from 'utils/makeWallet';\nimport ripemd160 from 'ripemd160';\nimport sha256 from 'js-sha256';\n\nconst ecdsa = new ec('secp256k1');\nconst COIN = 100000000;\nconst MY_ADDRESS = '1Nd85AnFYDtaQAG6vF9FVWXFWksG5HuA3M';\nconst FRIEND_ADDRESS = '1PDLNfJq5GAEn5StESZuBpaBe6B3134vmD';\n\n// hash the txid with SHA-256 and RIPEMD-160 algorithms\nexport function Hash(msg) {\n  return new ripemd160().update(sha256(msg)).digest('hex');\n}\n\n// sign a transaction input with private key\nexport function unlockTransaction(txid, privateKey) {\n  try {\n    // hash transaction ID\n    const hash = Hash(txid);\n    // initialize signing keys\n    const keys = ecdsa.keyFromPrivate(privateKey);\n    // sign txid hash with signing keys\n    const signature = ecdsa.sign(hash, keys);\n    // return in hexadecimal format\n    return signature.toDER('hex');\n  } catch (e) {\n    return null;\n  }\n}\n\n// verify that signature is owner of address and matches transaction\nexport function verifyUnlock(txid, address, publicKey, signature) {\n  try {\n    // first validate that address is derived from public key\n    const isAddress = getAddress(publicKey) === address;\n    if (!isAddress) {\n      return false;\n    }\n    const hash = Hash(txid);\n    const keys = ecdsa.keyFromPublic(publicKey, 'hex');\n    const isValid = keys.verify(hash, signature);\n    return isValid;\n  } catch (e) {\n    return false;\n  }\n}\n\nexport function testVerification(vin) {\n  console.log('> Testing digital signature....');\n  const { txid, prevout, scriptSig } = vin;\n  const [ publicKey, signature ] = scriptSig.split(' ');\n  console.log('> Public key: ', publicKey);\n  console.log('> Signature: ', signature);\n  return verifyUnlock(txid, prevout.scriptPubKey, publicKey, signature);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/verifySignature.js","import coinstring from 'coinstring';\nimport crypto from 'crypto';\nimport { ec } from 'elliptic';\nimport ripemd160 from 'ripemd160';\nimport secureRandom from 'secure-random';\nimport sha256 from 'js-sha256';\n\nconst ecdsa = new ec('secp256k1');\nconst DEFAULT_VERSION = { public: 0x0, private: 0x80 };\n\n// hash with both SHA-256 and RIPEMD-160 algorithms\nexport function Hash(msg) {\n  let hash = crypto.createHash('sha256').update(msg).digest();\n  return new ripemd160().update(hash).digest();\n}\n\n// get a base58 encoded BTC address given a user's public key\nexport function getAddress(publicKey) {\n  const publicKeyHash = Hash(publicKey);\n  return coinstring.encode(publicKeyHash, DEFAULT_VERSION.public);\n}\n\n\nexport function makeWallet() {\n  const privateKey = secureRandom.randomBuffer(32); // 32 byte random number\n  console.log('> Private key created: ', privateKey.toString('hex')); // convert to hexadecimal\n\n  // generate public key from private\n  const keys = ecdsa.keyFromPrivate(privateKey);\n  const publicKey = keys.getPublic('hex');\n  console.log('> Public key created: ', publicKey);\n\n  // generate public key hash\n  const publicKeyHash = Hash(publicKey);\n  console.log('> Public key hash created: ', publicKeyHash.toString('hex'));\n\n  // generate public address\n  const publicAddress = coinstring.encode(publicKeyHash, DEFAULT_VERSION.public);\n  console.log('> Public address created: ', publicAddress);\n\n  // generate private key WIF (wallet import format)\n  const privateKeyWIF = coinstring.encode(privateKey, DEFAULT_VERSION.private);\n  console.log('> Private key WIF (wallet import format) created : ', privateKeyWIF);\n\n  const wallet = {\n    privateKey: privateKey.toString('hex'),\n    publicKey,\n    publicKeyHash: publicKeyHash.toString('hex'),\n    privateKeyWIF,\n    publicAddress\n  };\n  return wallet;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/makeWallet.js","module.exports = require(\"coinstring\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"coinstring\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"secure-random\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"secure-random\"\n// module id = 10\n// module chunks = 0"],"sourceRoot":""}